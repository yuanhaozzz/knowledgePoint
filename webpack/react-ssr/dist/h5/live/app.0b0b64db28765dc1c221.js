(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{416:function(e,t,n){n(417),e.exports=n(776)},664:function(e,t,n){},756:function(e,t,n){},758:function(e,t,n){var s={"./af":277,"./af.js":277,"./ar":278,"./ar-dz":279,"./ar-dz.js":279,"./ar-kw":280,"./ar-kw.js":280,"./ar-ly":281,"./ar-ly.js":281,"./ar-ma":282,"./ar-ma.js":282,"./ar-sa":283,"./ar-sa.js":283,"./ar-tn":284,"./ar-tn.js":284,"./ar.js":278,"./az":285,"./az.js":285,"./be":286,"./be.js":286,"./bg":287,"./bg.js":287,"./bm":288,"./bm.js":288,"./bn":289,"./bn.js":289,"./bo":290,"./bo.js":290,"./br":291,"./br.js":291,"./bs":292,"./bs.js":292,"./ca":293,"./ca.js":293,"./cs":294,"./cs.js":294,"./cv":295,"./cv.js":295,"./cy":296,"./cy.js":296,"./da":297,"./da.js":297,"./de":298,"./de-at":299,"./de-at.js":299,"./de-ch":300,"./de-ch.js":300,"./de.js":298,"./dv":301,"./dv.js":301,"./el":302,"./el.js":302,"./en-SG":303,"./en-SG.js":303,"./en-au":304,"./en-au.js":304,"./en-ca":305,"./en-ca.js":305,"./en-gb":306,"./en-gb.js":306,"./en-ie":307,"./en-ie.js":307,"./en-il":308,"./en-il.js":308,"./en-nz":309,"./en-nz.js":309,"./eo":310,"./eo.js":310,"./es":311,"./es-do":312,"./es-do.js":312,"./es-us":313,"./es-us.js":313,"./es.js":311,"./et":314,"./et.js":314,"./eu":315,"./eu.js":315,"./fa":316,"./fa.js":316,"./fi":317,"./fi.js":317,"./fo":318,"./fo.js":318,"./fr":319,"./fr-ca":320,"./fr-ca.js":320,"./fr-ch":321,"./fr-ch.js":321,"./fr.js":319,"./fy":322,"./fy.js":322,"./ga":323,"./ga.js":323,"./gd":324,"./gd.js":324,"./gl":325,"./gl.js":325,"./gom-latn":326,"./gom-latn.js":326,"./gu":327,"./gu.js":327,"./he":328,"./he.js":328,"./hi":329,"./hi.js":329,"./hr":330,"./hr.js":330,"./hu":331,"./hu.js":331,"./hy-am":332,"./hy-am.js":332,"./id":333,"./id.js":333,"./is":334,"./is.js":334,"./it":335,"./it-ch":336,"./it-ch.js":336,"./it.js":335,"./ja":337,"./ja.js":337,"./jv":338,"./jv.js":338,"./ka":339,"./ka.js":339,"./kk":340,"./kk.js":340,"./km":341,"./km.js":341,"./kn":342,"./kn.js":342,"./ko":343,"./ko.js":343,"./ku":344,"./ku.js":344,"./ky":345,"./ky.js":345,"./lb":346,"./lb.js":346,"./lo":347,"./lo.js":347,"./lt":348,"./lt.js":348,"./lv":349,"./lv.js":349,"./me":350,"./me.js":350,"./mi":351,"./mi.js":351,"./mk":352,"./mk.js":352,"./ml":353,"./ml.js":353,"./mn":354,"./mn.js":354,"./mr":355,"./mr.js":355,"./ms":356,"./ms-my":357,"./ms-my.js":357,"./ms.js":356,"./mt":358,"./mt.js":358,"./my":359,"./my.js":359,"./nb":360,"./nb.js":360,"./ne":361,"./ne.js":361,"./nl":362,"./nl-be":363,"./nl-be.js":363,"./nl.js":362,"./nn":364,"./nn.js":364,"./pa-in":365,"./pa-in.js":365,"./pl":366,"./pl.js":366,"./pt":367,"./pt-br":368,"./pt-br.js":368,"./pt.js":367,"./ro":369,"./ro.js":369,"./ru":370,"./ru.js":370,"./sd":371,"./sd.js":371,"./se":372,"./se.js":372,"./si":373,"./si.js":373,"./sk":374,"./sk.js":374,"./sl":375,"./sl.js":375,"./sq":376,"./sq.js":376,"./sr":377,"./sr-cyrl":378,"./sr-cyrl.js":378,"./sr.js":377,"./ss":379,"./ss.js":379,"./sv":380,"./sv.js":380,"./sw":381,"./sw.js":381,"./ta":382,"./ta.js":382,"./te":383,"./te.js":383,"./tet":384,"./tet.js":384,"./tg":385,"./tg.js":385,"./th":386,"./th.js":386,"./tl-ph":387,"./tl-ph.js":387,"./tlh":388,"./tlh.js":388,"./tr":389,"./tr.js":389,"./tzl":390,"./tzl.js":390,"./tzm":391,"./tzm-latn":392,"./tzm-latn.js":392,"./tzm.js":391,"./ug-cn":393,"./ug-cn.js":393,"./uk":394,"./uk.js":394,"./ur":395,"./ur.js":395,"./uz":396,"./uz-latn":397,"./uz-latn.js":397,"./uz.js":396,"./vi":398,"./vi.js":398,"./x-pseudo":399,"./x-pseudo.js":399,"./yo":400,"./yo.js":400,"./zh-cn":401,"./zh-cn.js":401,"./zh-hk":402,"./zh-hk.js":402,"./zh-tw":403,"./zh-tw.js":403};function a(e){var t=r(e);return n(t)}function r(e){if(!n.o(s,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return s[e]}a.keys=function(){return Object.keys(s)},a.resolve=r,e.exports=a,a.id=758},767:function(e,t,n){},770:function(e,t,n){},771:function(e,t,n){},772:function(e,t,n){},774:function(e,t,n){},775:function(e,t,n){},776:function(e,t,n){"use strict";n.r(t);var s=n(0),a=n.n(s),r=n(8),o=n.n(r),i=n(123),c=n(75),l=n(214),u=n.n(l),d=(n(188),n(78)),m=(n(189),n(45)),f=(n(778),n(68)),p=(n(600),n(126)),h=(n(190),n(11)),g=n(36),y=n.n(g),v=n(37),b=n.n(v),j=n(38),S=n.n(j),w=n(39),I=n.n(w),E=n(13),D=n.n(E),O=n(40),k=n.n(O),N=n(10),C=n.n(N),M=n(33),T="LOGIN",U="SEND_COURSE_DETAIL",L="SHOW_DIALOG",R="HIDE_DIALOG",V="SELECT_STUDENT",x="COURSE_LIST",P=n(52),z=n.n(P),_=n(100),J=n.n(_),F=n(406),W=n.n(F),G=n(407),q=n.n(G),A=W.a.create({timeout:6e3});A.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded",A.interceptors.request.use(function(e){return console.log(e),"post"===e.method&&(e.data=q.a.stringify(e.data)),e},function(e){return loadinginstace.close(),Promise.reject(e)});var H=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise(function(s,a){A.post(e,t,n).then(function(e){var t=e.data.status.code;e.data.data.systemDate=e.data.systemDate,0===t?s(e.data.data):(console.log(e,"---------------------12"),d.a.error(e.data.status.message),a(e.data.message))}).catch(function(e,t){console.log(e,"-------------------err"),a(e,t)})})},$="";$="http://pre.beiwaiguoji.com/api";var B,Y,K,Q,X,Z=function(e){return $+e},ee={USER:{LOGINJUMP:Z("/ucenter/dispatch?action=loginWithPassword"),SEND_CODE:Z("/ucenter/dispatch?action=sendUserSms"),LOGIN_PHONE:Z("/ucenter/dispatch?action=loginSms")}},te={getUserInfo:(K=J()(z.a.mark(function e(t){return z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H(ee.USER.LOGINJUMP,t,{});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)})),function(e){return K.apply(this,arguments)}),sendCode:(Y=J()(z.a.mark(function e(t){return z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H(ee.USER.SEND_CODE,t,{});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)})),function(e){return Y.apply(this,arguments)}),getPhoneUserInfo:(B=J()(z.a.mark(function e(t){return z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H(ee.USER.LOGIN_PHONE,t,{});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)})),function(e){return B.apply(this,arguments)})},ne={calendar:{list:Z("/live/dispatch?action=liveCalendar"),entryStudio:Z("/live/dispatch?action=callbackNotify")}},se={getList:(X=J()(z.a.mark(function e(t,n){return z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H(ne[t].list,n,{});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)})),function(e,t){return X.apply(this,arguments)}),sendStudioCallback:(Q=J()(z.a.mark(function e(t,n){return z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H(ne[t].entryStudio,n,{});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)})),function(e,t){return Q.apply(this,arguments)})};function ae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,s)}return n}function re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ae(n,!0).forEach(function(t){C()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ae(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function oe(e){return{type:U,payload:re({},e)}}function ie(e){return{type:T,payload:re({},e)}}function ce(e){return{type:L,payload:re({},e)}}function le(e){return{type:V,payload:re({},e)}}function ue(e){return function(t){return se.getList("calendar",e).then(function(e){var n;t((n={courseList:e.calendarList},console.log(n,"---------------------------a"),{type:x,payload:re({},n)}))})}}var de=function(e,t){if(!e)return"";t=t||"yyyy-MM-dd hh:mm";var n=new Date(e);/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(n.getFullYear()+"").substr(4-RegExp.$1.length)));var s={"M+":n.getMonth()+1,"d+":n.getDate(),"h+":n.getHours(),"m+":n.getMinutes(),"s+":n.getSeconds()};for(var a in s)if(new RegExp("(".concat(a,")")).test(t)){var r=s[a]+"";t=t.replace(RegExp.$1,1===RegExp.$1.length?r:("00"+r).substr(r.length))}return t},me=function(e,t,n){console.log(n);for(var s=0;s<e.length;s++)if(de(e[s][t],"yyyy-MM-dd")===n)return e[s];return!1},fe=function(e,t,n){for(var s=0;s<e.length;s++)if(e[s][t]===n)return e[s];return!1},pe=function(e,t,n){var s=new Date,a=n;s.setTime(s.getTime()+24*a*3600*1e3),document.cookie=e+"="+t+";expires="+s.toGMTString()},he=function(){return window.WCRClassRoom&&window.WCRClassRoom.getClientType()},ge=function(){for(var e=[],t=0;t<36;t++)e[t]="0123456789abcdef".substr(Math.floor(16*Math.random()),1);return e[14]="4",e[19]="0123456789abcdef".substr(3&e[19]|8,1),e[8]=e[13]=e[18]=e[23]="-",e.join("")},ye=(n(664),function(e){function t(e){var n;return y()(this,t),n=S()(this,I()(t).call(this,e)),C()(D()(n),"handleSubmit",function(e){e.preventDefault(),n.props.form.validateFields(function(e,t){e||n.props.handleSubmit("account",{loginName:t.username,password:t.password})})}),C()(D()(n),"switchMethod",function(e){n.props.switchMethod(2)}),n.state={loading:!1,info:{}},n}return k()(t,e),b()(t,[{key:"componentDidMount",value:function(){this.setState({info:JSON.parse(localStorage.getItem("info"))||{}})}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return a.a.createElement(f.a,{onSubmit:this.handleSubmit,className:"login-form"},a.a.createElement(f.a.Item,null,e("username",{initialValue:this.state.info.loginName||"",rules:[{required:!0,message:"请输入账号!"}]})(a.a.createElement(p.a,{prefix:a.a.createElement(h.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"用户名"}))),a.a.createElement(f.a.Item,null,e("password",{initialValue:this.state.info.password||"",rules:[{required:!0,message:"请输入密码！"}]})(a.a.createElement(p.a,{prefix:a.a.createElement(h.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"密码"}))),a.a.createElement("p",{className:"login-form-phone",onClick:this.switchMethod},"手机号登陆？"),a.a.createElement(f.a.Item,null,a.a.createElement(m.a,{type:"primary",block:!0,htmlType:"submit",loading:this.state.loading,className:"login-form-button"},"登录")))}}]),t}(s.Component)),ve=function(e){function t(e){var n;return y()(this,t),n=S()(this,I()(t).call(this,e)),C()(D()(n),"handleSubmit",function(e){e.preventDefault(),n.props.form.validateFields(function(e,t){e||n.props.handleSubmit("phone",{mobile:t.phone,smsCode:t.code})})}),C()(D()(n),"switchMethod",function(e){n.props.switchMethod(1)}),C()(D()(n),"sendCode",function(e){n.props.form.validateFields(["phone"],function(e){if(!e){n.setState(function(e){return{isSend:!0}});var t={mobile:n.props.form.getFieldValue("phone"),userSmsType:0,deviceType:1,deviceSerialNo:"pc"+n.props.uuid};te.sendCode(t).then(function(e){n.setState({interval:setInterval(function(){n.setState(function(e,t){return{number:--e.number}}),57===n.state.number&&n.setState(function(e){return clearInterval(n.state.interval),{isSend:!1,number:60}})},1e3)})}).catch(function(e){n.setState(function(e){return{isSend:!1}})})}})}),C()(D()(n),"validatorPhone",function(e,t,n){console.log(t,"---");0===t.length?n("请输入手机号码"):/^1[3456789]\d{9}$/.test(t)||n("手机号码输入有误"),n()}),n.state={loading:!1,info:{},isSend:!1,number:60,interval:null,phone:""},n}return k()(t,e),b()(t,[{key:"render",value:function(){var e=this,t=this.props.form.getFieldDecorator,n=this.state,s=n.isSend,r=n.number;return a.a.createElement(f.a,{onSubmit:this.handleSubmit,className:"login-form"},a.a.createElement(f.a.Item,null,t("phone",{initialValue:this.state.phone||"",rules:[{validator:function(t,n,s){return e.validatorPhone(t,n,s)}}]})(a.a.createElement(p.a,{prefix:a.a.createElement(h.a,{type:"phone",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"手机号"}))),a.a.createElement(f.a.Item,null,t("code",{rules:[{required:!0,message:"请输入验证码!"}]})(a.a.createElement("div",{className:"flex-center phone-box"},a.a.createElement(p.a,{placeholder:"验证码"})," ",a.a.createElement(m.a,{type:"primary",onClick:this.sendCode,disabled:s},s?r+"s":"发送")))),a.a.createElement("p",{className:"login-form-phone",onClick:this.switchMethod},"账号密码登陆？"),a.a.createElement(f.a.Item,null,a.a.createElement(m.a,{type:"primary",block:!0,htmlType:"submit",loading:this.state.loading,className:"login-form-button"},"登录")))}}]),t}(s.Component),be=function(e){function t(e){var n;return y()(this,t),n=S()(this,I()(t).call(this,e)),C()(D()(n),"handleSubmit",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"account",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};n.props.form.validateFields(function(s){if(!s){n.setState({loading:!0}),localStorage.setItem("uuid",n.state.uuid);var a={deviceType:1,deviceSerialNo:"pc-"+n.state.uuid},r=te.getUserInfo;"account"===e?(a.loginName=t.loginName,a.password=t.password):(a.mobile=t.mobile,a.smsCode=t.smsCode,r=te.getPhoneUserInfo),r(a).then(function(e){var s=he();if(1===e.userMessageVo.userType&&"student"===s)return d.a.error("请登录教师端！"),void n.setState({loading:!1});if(1!==e.userMessageVo.userType&&"teacher"===s)return d.a.error("请登录学生端！"),void n.setState({loading:!1});if(4===e.userMessageVo.userType&&0===e.userMessageVo.subUserInfoVoList.length)return d.a.error("您未添加学生"),void n.setState({loading:!1});n.setState({loading:!1});var a={};e.userMessageVo.subUserInfoVoList.length>0?(a.id=e.userMessageVo.subUserInfoVoList[0].userId,a.name=e.userMessageVo.subUserInfoVoList[0].userName,a.password="0",a.token=e.userMessageVo.loginToken,a.avatar="http://snsimg.ztjystore.cn/ztnew/ad/img/2019/07/05/1562295571719403.png",a.mobile=e.userMessageVo.subUserInfoVoList[0].mobile||"0",e.userMessageVo.subUserInfoVoList[0].select=!0,n.props.setStudent({studentInfo:e.userMessageVo.subUserInfoVoList[0]})):(a.id=e.userMessageVo.userId,a.name=e.userMessageVo.userName,a.password="0",a.token=e.userMessageVo.loginToken,a.avatar="http://snsimg.ztjystore.cn/ztnew/ad/img/2019/07/05/1562295571719403.png",a.mobile=e.userMessageVo.mobile||"0",n.props.setStudent({studentInfo:e.userMessageVo}),e.userMessageVo.select=!0);a.type={1:"teacher",2:"student",3:"student",4:"student"}[e.userMessageVo.userType]||"student",n.props.setUserInfo({userInfo:e.userMessageVo}),pe("userInfo",encodeURI(JSON.stringify(e.userMessageVo)),30),localStorage.setItem("userInfo",JSON.stringify(e.userMessageVo)),localStorage.setItem("info",JSON.stringify({loginName:t.loginName,password:t.password})),window.WCRClassRoom.setUser(JSON.stringify(a)),n.props.history.push("/h5/live/broadcast/course")}).catch(function(e){n.setState({loading:!1})})}})}),C()(D()(n),"switchMethod",function(e){n.setState({loginType:e})}),n.state={loginType:1,info:{},uuid:""},n}return k()(t,e),b()(t,[{key:"componentDidMount",value:function(){this.setState({info:JSON.parse(localStorage.getItem("info"))||{},uuid:localStorage.getItem("uuid")?localStorage.getItem("uuid"):ge()}),console.log(localStorage.getItem("info"))}},{key:"render",value:function(){var e=this.state.loginType;return a.a.createElement(s.Fragment,null,a.a.createElement("div",{className:"login-wrapper"},a.a.createElement("div",{className:"login-wrapper-layout"},a.a.createElement("div",{className:"login-logo"}),1===e&&a.a.createElement(ye,u()({handleSubmit:this.handleSubmit,switchMethod:this.switchMethod},this.props,{info:this.state.info})),2===e&&a.a.createElement(ve,u()({handleSubmit:this.handleSubmit,uuid:this.state.uuid,switchMethod:this.switchMethod},this.props)))))}}]),t}(s.Component),je=f.a.create({name:"normal_login"})(be),Se=Object(M.connect)(null,{setUserInfo:ie,setStudent:le})(je),we=n(212),Ie=n.n(we),Ee=(n(777),n(413)),De=(n(756),"");function Oe(){return a.a.createElement("div",{className:"calendar-header flex-center"},a.a.createElement("div",{className:"calendar-header-refresh flex-center",onClick:function(){window.webAdapter.reload()}},a.a.createElement(h.a,{type:"sync",style:{fontSize:"18px",color:"#5fa2ee"}})))}var ke=function(e){function t(e){var n;return y()(this,t),n=S()(this,I()(t).call(this,e)),C()(D()(n),"filterMonthsCourse",function(e){var t=[];return n.props.courseData.forEach(function(n){de(n.date,"yyyy-MM-dd")===e&&t.push(n)}),t}),C()(D()(n),"dateCellRender",function(e){var t=e.month()+1<10?"0"+(e.month()+1):e.month()+1,s=e.date()<10?"0"+e.date():e.date(),r=e.year(),o=n.filterMonthsCourse("".concat(r,"-").concat(t,"-").concat(s));return a.a.createElement("ul",{className:"events"},o.map(function(e){return a.a.createElement("div",{key:e.date,className:"date-item"})}))}),C()(D()(n),"onSelect",function(e){var t=e.month()+1<10?"0"+(e.month()+1):e.month()+1,s="".concat(e.year(),"-").concat(t,"-").concat(e.date()<10?"0"+e.date():e.date()),a=me(n.props.courseData,"date",s)||{};De===e.month()&&n.props.sendCourseDetail({courseData:a})}),C()(D()(n),"onPanelChange",function(e){n.props.changeDate(e)}),n}return k()(t,e),b()(t,[{key:"render",value:function(){return a.a.createElement(s.Fragment,null,a.a.createElement(Oe,null),a.a.createElement("div",{className:"calendar-wrapper"},a.a.createElement(Ee.a,{onPanelChange:this.onPanelChange,onSelect:this.onSelect,dateCellRender:this.dateCellRender,fullscreen:!1,ref:"myInput",headerRender:function(e){var t=e.value,n=e.onChange;De=t.month();var s=t.year();return a.a.createElement("div",{style:{padding:10}},a.a.createElement("div",{className:"flex-center"},a.a.createElement("div",{className:"calendar-caret flex-center",onClick:function(){var e=De,s=t.clone();s.month(parseInt(--e,10)),n(s)}},a.a.createElement(h.a,{type:"caret-left",style:{fontSize:"20px",color:"#a9a9a9"}})),a.a.createElement("div",{className:"calendar-date"},"".concat(s,"年").concat(De+1,"月")),a.a.createElement("div",{className:"calendar-caret flex-center",onClick:function(){var e=De,s=t.clone();s.month(parseInt(++e,10)),n(s)}},a.a.createElement(h.a,{type:"caret-right",style:{fontSize:"20px",color:"#a9a9a9"}}))))}})))}}]),t}(s.Component),Ne=Object(M.connect)(null,{sendCourseDetail:oe})(ke),Ce=n(1),Me=n.n(Ce),Te=(n(767),function(e){function t(e){var n;return y()(this,t),n=S()(this,I()(t).call(this,e)),C()(D()(n),"handleSignOut",function(){window.WCRClassRoom.setUser(""),Router.push("/broadcast/login")}),C()(D()(n),"handleSwitchStudent",function(){n.props.showDialog({status:!0})}),C()(D()(n),"handleAvatar",function(){}),C()(D()(n),"handleGender",function(e){return 1===e.gender?"http://snsimg.ztjystore.cn/1562303034TyAFquWFiu":2===e.gender?"http://snsimg.ztjystore.cn/ztnew/ad/img/2019/07/05/1562291591660101.jpg?imageView2/2/w/720":"http://snsimg.ztjystore.cn/article/2019/07/05/1562281563183957.jpg?imageView2/2/w/720"}),n.state={platform:""},n}return k()(t,e),b()(t,[{key:"componentDidMount",value:function(){this.setState({platform:he()})}},{key:"render",value:function(){var e=fe(this.props.studentInfo,"select",!0);return a.a.createElement("aside",{className:"sidebar-container"},a.a.createElement("div",{className:"sidebar-avatar",style:{background:"url(".concat(this.handleGender(e),") no-repeat")}}),a.a.createElement("div",{className:"sidebar-name"},e.userName),a.a.createElement("ul",{className:"nav"},a.a.createElement("li",{className:"nav-item"},a.a.createElement(h.a,{type:"calendar"}),a.a.createElement("div",{className:"nav-item-title"},"课程表")),"student"===this.state.platform&&a.a.createElement("li",{className:"nav-item",onClick:this.handleSwitchStudent},a.a.createElement(h.a,{type:"team"}),a.a.createElement("div",{className:"nav-item-title"},"切换学生")),a.a.createElement("li",{className:"nav-item",onClick:this.handleSignOut},a.a.createElement(h.a,{type:"logout"}),a.a.createElement("div",{className:"nav-item-title"},"退出登录"))))}}]),t}(s.Component));Te.propTypes={userInfo:Me.a.object.isRequired},Te.defaultProps={userInfo:{}};var Ue=Object(M.connect)(function(e){return{studentInfo:e.course.studentInfo}},{showDialog:ce})(Te),Le=(n(768),n(414)),Re=(n(770),function(e){function t(e){var n;return y()(this,t),n=S()(this,I()(t).call(this,e)),C()(D()(n),"handleOk",function(e){}),C()(D()(n),"handleStudentInfo",function(e){e.select||n.props.handleDialogSwitchStudent(e.userId),n.state.students.map(function(t){t.select=!1,e.userId===t.userId&&(t.select=!0)});var t=JSON.parse(JSON.stringify(n.props.userInfo));t.subUserInfoVoList=JSON.parse(JSON.stringify(n.state.students)),n.props.setStudent({studentInfo:JSON.parse(JSON.stringify(n.state.students))}),pe("userInfo",encodeURI(JSON.stringify(t)),30),localStorage.setItem("userInfo",JSON.stringify(t)),n.handleLogin(e),n.props.hideDialog({status:!1})}),C()(D()(n),"handleLogin",function(e){window.WCRClassRoom.setUser("");var t={id:e.userId,name:e.userName,password:"0",token:n.props.userInfo.loginToken,avatar:"http://snsimg.ztjystore.cn/ztnew/ad/img/2019/07/05/1562295571719403.png",mobile:e.mobile||0,type:"student"};window.WCRClassRoom.setUser(t)}),C()(D()(n),"handleGender",function(e){return 1===e.gender?"http://snsimg.ztjystore.cn/1562303034TyAFquWFiu":2===e.gender?"http://snsimg.ztjystore.cn/ztnew/ad/img/2019/07/05/1562291591660101.jpg?imageView2/2/w/720":"http://snsimg.ztjystore.cn/article/2019/07/05/1562281563183957.jpg?imageView2/2/w/720"}),C()(D()(n),"handleCancel",function(e){n.props.hideDialog({status:!1})}),n.state={loading:!1,students:[]},n}return k()(t,e),b()(t,[{key:"componentDidMount",value:function(){var e=JSON.parse(localStorage.getItem("userInfo")).subUserInfoVoList;this.setState({students:e})}},{key:"render",value:function(){var e=this;return a.a.createElement("div",null,a.a.createElement(Le.a,{visible:this.props.status,title:"切换学生",onOk:this.handleOk,onCancel:this.handleCancel,width:"50%",footer:null},a.a.createElement("div",{className:"student"},this.state.students.map(function(t,n){return a.a.createElement("div",{key:n,className:"student-item",onClick:function(){return e.handleStudentInfo(t)}},a.a.createElement("div",{className:"student-item-avatar",style:{background:"url(".concat(e.handleGender(t),") no-repeat")}}),a.a.createElement("div",{className:"student-item-name"},t.userName),t.select&&a.a.createElement("div",{className:"student-item-icon"},"当前"))}))))}}]),t}(s.Component));Object(M.connect)(function(e){return{status:e.course.status}},{showDialog:ce,hideDialog:function(e){return{type:R,payload:re({},e)}},setStudent:le})(Re),n(771);function Ve(){return a.a.createElement(s.Fragment,null,a.a.createElement("div",{className:"course-header flex-center"},"我的课程"))}function xe(e){var t=e.courseData,n=void 0===t?{}:t,r=(e.userInfo,e.clearInterval);function o(e,t){var n;return{text:{1:"待上课",2:"开课中",3:"已下课",4:"无效",5:"已失效"},color:(n={3:"#e2e2e2"},C()(n,"3","#e2e2e2"),C()(n,"5","#e2e2e2"),C()(n,"1","#a6d4f5"),C()(n,"2","#a6d4f5"),n),button:{1:"进入教室",2:"进入教室",3:"查看回放",4:"无效",5:"已失效"},type:{1:"0",2:"7",3:"2"},courseStatus:{1:1,2:2,3:3,4:-1,5:4}}[t][e]}function i(e){if(1===e.status||2===e.status||3===e.status){var t={institutionId:1014,id:e.id,title:e.title,scenario:o(e.classType,"type"),startTime:e.startTime,endTime:e.endTime,status:o(e.status,"courseStatus"),teacher_name:e.teacher.userName,teacher_id:e.teacher.id,lesson_slide_url:e.broadcastingInfo.lessonSlideUrl,lesson_slide_backup_url:e.broadcastingInfo.lessonSlideBackupUrl};e.actualStartTime&&(t.actualStartTime=e.actualStartTime),3===e.classType&&(t.needLianMai=1,t.record_mode=4),2===e.classType&&(t.students=[],e.broadcastingInfo.students.forEach(function(e){t.students.push({id:e.id,name:e.userName,avatar:e.avatar})}));var n=JSON.parse(localStorage.getItem("userInfo")),s={token:n.loginToken};n.subUserInfoVoList.length>0?s.subUserId=fe(n.subUserInfoVoList,"select",!0).userId:s.subUserId=n.userId,console.log(JSON.stringify(s)),WCRClassRoom.joinClassRoom(JSON.stringify(t),function(t){!function(e,t,n){if("startClass"===e.notify){window.WCRClassRoom.web_log(JSON.stringify(e)),console.log("点击上课按钮"),console.log(n.subUserId);var s={token:n.token,subUserId:n.subUserId,notify:"startClass",data:JSON.stringify(e.body)};se.sendStudioCallback("calendar",s).then(function(e){c({status:1,lesson:t.id,actual_time:t.actualStartTime?de(t.actualStartTime,"yyyy-MM-dd hh:mm:ss"):de(e.systemDate,"yyyy-MM-dd hh:mm:ss"),server_time:de(e.systemDate,"yyyy-MM-dd hh:mm:ss"),notify:"startClass"}),console.log({status:1,lesson:t.id,actual_time:t.actualStartTime?de(t.actualStartTime,"yyyy-MM-dd hh:mm:ss"):de(e.systemDate,"yyyy-MM-dd hh:mm:ss"),server_time:de(e.systemDate,"yyyy-MM-dd hh:mm:ss"),notify:"startClass",time:t.actualStartTime},"--------")}).catch(function(e){c({status:2,lesson:t.id,actual_time:t.actualStartTime?de(t.actualStartTime,"yyyy-MM-dd hh:mm:ss"):de(res.systemDate,"yyyy-MM-dd hh:mm:ss"),server_time:de(res.systemDate,"yyyy-MM-dd hh:mm:ss"),notify:"startClass"})})}else if("endClass"===e.notify){WCRClassRoom.web_log(JSON.stringify(e)),console.log("点击下课按钮");var a={token:n.token,subUserId:n.subUserId,notify:"endClass",data:JSON.stringify(e.body)};se.sendStudioCallback("calendar",a).then(function(e){c({status:1,lesson:t.id,notify:"endClass"})}).catch(function(e){c({status:2,lesson:t.id,notify:"endClass"})})}else"enterClassRoom"===e.notify?(r(),console.log("进入教室"),WCRClassRoom.web_log(JSON.stringify(e))):"leaveClassRoom"===e.notify?(WCRClassRoom.web_log(JSON.stringify(e)),window.webAdapter.reload(),console.log("离开教室")):"rewardinfo"===e.notify&&console.log(JSON.parse(JSON.stringify(e)))}(t,e,s)})}d.a.warning("该课程".concat(已失效))}function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.status,n=e.lesson,s=e.actual_time,a=e.server_time,r=e.notify,o={notify:r,body:{status:t}};"startClass"===r&&(o.body.data={lesson:n,actual_time:s,server_time:a}),"endClass"===r&&(o.body.data={lesson:n}),window.WCRClassRoom.commonNotifyCallback(0,o)}return Object.keys(n).length<1?a.a.createElement(s.Fragment,null,a.a.createElement("div",{className:"no-data"},"暂无课程")):a.a.createElement("ul",{className:"list-item hide-scroll"},n.courseList.map(function(e){return a.a.createElement("li",{key:e.id},a.a.createElement("p",{className:"list-item-title"},e.title),a.a.createElement("p",{className:"list-item-type"},function(e){switch(e){case 1:return"一对一";case 2:return"小班课";case 3:return"大班课";case 4:return"广播课"}}(e.classType),"  ",de(+new Date(e.startTime.replace(/-/g,"/")),"hh:mm"),"-",de(+new Date(e.endTime.replace(/-/g,"/")),"hh:mm")),a.a.createElement("p",{className:"list-item-name"},e.teacher.userName),a.a.createElement("div",{className:"list-item-status",style:{backgroundColor:o(e.status,"color")}},o(e.status,"text")),a.a.createElement("dir",{className:"list-item-button"},a.a.createElement("button",{onClick:function(){return i(e)}},o(e.status,"button"))))}))}var Pe=function(e){function t(e){return y()(this,t),S()(this,I()(t).call(this,e))}return k()(t,e),b()(t,[{key:"render",value:function(){var e=this.props,t=e.courseData,n=e.userInfo,r=e.clearInterval;return a.a.createElement(s.Fragment,null,a.a.createElement(Ve,{userInfo:n}),a.a.createElement(xe,{userInfo:n,clearInterval:r,courseData:t}))}}]),t}(s.Component),ze=Object(M.connect)(function(e){return{courseData:e.course.courseData}},null)(Pe);n(772);function _e(e,t){var n=new Date(e),s=n.getMonth()+1,a=n.getFullYear(),r=20;return"startDate"===t?0===--s&&(s=12,--a):(r=10,13===++s&&(s=1,++a)),"".concat(a,"-").concat(s<10?"0"+s:s,"-").concat(r)}var Je=function(e){function t(e){var n;return y()(this,t),n=S()(this,I()(t).call(this,e)),C()(D()(n),"clientRequest",function(){var e=n.props.userInfo,t={token:e.loginToken,startDate:_e(new Date,"startDate"),endDate:_e(new Date,"endDate")};e.subUserInfoVoList.length>0?t.subUserId=fe(e.subUserInfoVoList,"select",!0).userId:t.subUserId=e.userId,n.props.awaitCourseList(t)}),C()(D()(n),"clearInterval",function(e){n.setState(function(e){clearTimeout(e.interval)})}),C()(D()(n),"handleUserId",function(e){n.props.userInfo.subUserInfoVoList.length>0?n.getCourseList(n.state.studentId||fe(n.props.userInfo.subUserInfoVoList,"select",!0).userId):n.getCourseList(n.props.userInfo.userId)}),C()(D()(n),"changeDate",function(e){var t="".concat(e.year(),"-").concat(e.month()+1<10?"0"+(e.month()+1):e.month()+1,"-").concat(e.date()<10?"0"+e.date():e.date()),s="".concat(e.year(),"-").concat(e.month()+1<10?"0"+(e.month()+1):e.month()+1);n.setState(function(e){e.currentDate=s,e.yearMonth=s,e.changeDate=t,n.handleUserId()})}),C()(D()(n),"getCourseList",function(e){var t={token:n.props.userInfo.loginToken,subUserId:e,startDate:_e(n.state.yearMonth,"startDate"),endDate:_e(n.state.yearMonth,"endDate")};n.props.userInfo.subUserInfoVoList.length>0&&(t.subUserId=e),se.getList("calendar",t).then(function(e){n.setState({courseData:e.calendarList}),n.checkTodayCourse(+new Date(n.state.changeDate))})}),C()(D()(n),"handleDialogSwitchStudent",function(e){n.setState({studentId:e}),n.getCourseList(e)}),C()(D()(n),"checkTodayCourse",function(e){var t=de(e,"yyyy-MM-dd");console.log(1),n.props.sendCourseDetail({courseData:me(n.state.courseData,"date",t)||{}})}),C()(D()(n),"showLesson",function(){var e=n.props.courseDataStore,t={lesson:0,lessonLength:0};return Object.keys(e).length<1?t:(t.lesson=e.courseList.length,t.lessonLength=e.courseList.filter(function(e){return 1!==e.status&&2!==e.status}).length,t)}),n.state={courseData:[],currentDate:new Date,interval:null,yearMonth:de(+new Date,"yyyy-MM"),changeDate:de(+new Date,"yyyy-MM-dd"),studentId:""},n.props.userInfo.subUserInfoVoList.length>0?n.props.setStudent({studentInfo:n.props.userInfo.subUserInfoVoList}):n.props.setStudent({studentInfo:[n.props.userInfo]}),n}return k()(t,e),b()(t,[{key:"componentWillMount",value:function(){this.props.courseListStore||(this.clientRequest(),this.setState({courseData:this.props.courseListStore}))}},{key:"componentDidMount",value:function(){console.log(this.props.courseListStore),console.log(this.props.userInfo,"2"),window.resizeTo(1080,650),this.handleUserId(),this.setState({})}},{key:"render",value:function(){var e=this.props.userInfo;return a.a.createElement(s.Fragment,null,a.a.createElement("div",{className:"content-layout"},a.a.createElement(Ue,{userInfo:e}),a.a.createElement("div",{className:"content-layout-right flex-center"},a.a.createElement("div",{className:"content-layout-right-box"},a.a.createElement("div",{className:"content-layout-right-caleandar"},a.a.createElement(Ne,{changeDate:this.changeDate,courseData:this.state.courseData})),a.a.createElement("div",{className:"content-layout-right-course"},a.a.createElement(ze,{clearInterval:this.clearInterval,userInfo:e}))),a.a.createElement("div",{className:"content-layout-right-carryout"},"共",this.showLesson().lesson,"节课 | 完成",this.showLesson().lessonLength,"节"))))}}]),t}(s.Component),Fe=Object(M.connect)(function(e){var t=e.course,n=t.courseList;return{courseDataStore:t.courseData,courseListStore:n,userInfo:e.login.userInfo}},{sendCourseDetail:oe,setStudent:le,setUserInfo:ie})(Je);Fe.getInintalProps=function(e,t){var n=JSON.parse(t.userInfo);console.log(Ie()(n),"router----------------------"),console.log(n,"router----------------------"),e.dispatch(ie({userInfo:n}));var s={token:n.loginToken,startDate:_e(new Date,"startDate"),endDate:_e(new Date,"endDate")};return n.subUserInfoVoList.length>0?s.subUserId=fe(n.subUserInfoVoList,"select",!0).userId:s.subUserId=n.userId,console.log(s,"----------------2"),e.dispatch(ue(s))};var We=[{path:"/",component:Se,exact:!0,key:"Home"},{path:"/h5/live/broadcast/login",component:Se,key:"login",exact:!0},{path:"/h5/live/broadcast/course",component:Fe,key:"course",exact:!0,loadData:Fe.getInintalProps}],Ge=function(){return a.a.createElement(s.Fragment,null,We.map(function(e){return a.a.createElement(c.Route,e)}))},qe=n(66),Ae=n(219);function He(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,s)}return n}function $e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?He(n,!0).forEach(function(t){C()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):He(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Be={courseData:{},status:!1,studentInfo:{},courseList:{}};function Ye(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,s)}return n}function Ke(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ye(n,!0).forEach(function(t){C()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ye(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Qe={userInfo:null,list:[]},Xe=Object(qe.combineReducers)({course:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Be,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case U:var n=t.payload;return $e({},e,{},n);case L:case R:case V:case x:return $e({},e,{},t.payload);default:return e}},login:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case T:return t.payload,Ke({},e,{},t.payload);case"TEST":return Ke({},e,{},t.payload);default:return e}}});n(774),n(775);var Ze=function(){return a.a.createElement(M.Provider,{store:(e=window._REACT_SOTRE?window._REACT_SOTRE:{},Object(qe.createStore)(Xe,e,Object(qe.applyMiddleware)(Ae.a)))},a.a.createElement(i.BrowserRouter,null,a.a.createElement(Ge,null)));var e};o.a.hydrate(a.a.createElement(Ze,null),document.getElementById("root"))}},[[416,1,2]]]);
//# sourceMappingURL=app.0b0b64db28765dc1c221.js.map