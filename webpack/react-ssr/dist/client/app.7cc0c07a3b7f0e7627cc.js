(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{373:function(e,t,n){},465:function(e,t,n){},467:function(e,t,n){var s={"./af":159,"./af.js":159,"./ar":160,"./ar-dz":161,"./ar-dz.js":161,"./ar-kw":162,"./ar-kw.js":162,"./ar-ly":163,"./ar-ly.js":163,"./ar-ma":164,"./ar-ma.js":164,"./ar-sa":165,"./ar-sa.js":165,"./ar-tn":166,"./ar-tn.js":166,"./ar.js":160,"./az":167,"./az.js":167,"./be":168,"./be.js":168,"./bg":169,"./bg.js":169,"./bm":170,"./bm.js":170,"./bn":171,"./bn.js":171,"./bo":172,"./bo.js":172,"./br":173,"./br.js":173,"./bs":174,"./bs.js":174,"./ca":175,"./ca.js":175,"./cs":176,"./cs.js":176,"./cv":177,"./cv.js":177,"./cy":178,"./cy.js":178,"./da":179,"./da.js":179,"./de":180,"./de-at":181,"./de-at.js":181,"./de-ch":182,"./de-ch.js":182,"./de.js":180,"./dv":183,"./dv.js":183,"./el":184,"./el.js":184,"./en-SG":185,"./en-SG.js":185,"./en-au":186,"./en-au.js":186,"./en-ca":187,"./en-ca.js":187,"./en-gb":188,"./en-gb.js":188,"./en-ie":189,"./en-ie.js":189,"./en-il":190,"./en-il.js":190,"./en-nz":191,"./en-nz.js":191,"./eo":192,"./eo.js":192,"./es":193,"./es-do":194,"./es-do.js":194,"./es-us":195,"./es-us.js":195,"./es.js":193,"./et":196,"./et.js":196,"./eu":197,"./eu.js":197,"./fa":198,"./fa.js":198,"./fi":199,"./fi.js":199,"./fo":200,"./fo.js":200,"./fr":201,"./fr-ca":202,"./fr-ca.js":202,"./fr-ch":203,"./fr-ch.js":203,"./fr.js":201,"./fy":204,"./fy.js":204,"./ga":205,"./ga.js":205,"./gd":206,"./gd.js":206,"./gl":207,"./gl.js":207,"./gom-latn":208,"./gom-latn.js":208,"./gu":209,"./gu.js":209,"./he":210,"./he.js":210,"./hi":211,"./hi.js":211,"./hr":212,"./hr.js":212,"./hu":213,"./hu.js":213,"./hy-am":214,"./hy-am.js":214,"./id":215,"./id.js":215,"./is":216,"./is.js":216,"./it":217,"./it-ch":218,"./it-ch.js":218,"./it.js":217,"./ja":219,"./ja.js":219,"./jv":220,"./jv.js":220,"./ka":221,"./ka.js":221,"./kk":222,"./kk.js":222,"./km":223,"./km.js":223,"./kn":224,"./kn.js":224,"./ko":225,"./ko.js":225,"./ku":226,"./ku.js":226,"./ky":227,"./ky.js":227,"./lb":228,"./lb.js":228,"./lo":229,"./lo.js":229,"./lt":230,"./lt.js":230,"./lv":231,"./lv.js":231,"./me":232,"./me.js":232,"./mi":233,"./mi.js":233,"./mk":234,"./mk.js":234,"./ml":235,"./ml.js":235,"./mn":236,"./mn.js":236,"./mr":237,"./mr.js":237,"./ms":238,"./ms-my":239,"./ms-my.js":239,"./ms.js":238,"./mt":240,"./mt.js":240,"./my":241,"./my.js":241,"./nb":242,"./nb.js":242,"./ne":243,"./ne.js":243,"./nl":244,"./nl-be":245,"./nl-be.js":245,"./nl.js":244,"./nn":246,"./nn.js":246,"./pa-in":247,"./pa-in.js":247,"./pl":248,"./pl.js":248,"./pt":249,"./pt-br":250,"./pt-br.js":250,"./pt.js":249,"./ro":251,"./ro.js":251,"./ru":252,"./ru.js":252,"./sd":253,"./sd.js":253,"./se":254,"./se.js":254,"./si":255,"./si.js":255,"./sk":256,"./sk.js":256,"./sl":257,"./sl.js":257,"./sq":258,"./sq.js":258,"./sr":259,"./sr-cyrl":260,"./sr-cyrl.js":260,"./sr.js":259,"./ss":261,"./ss.js":261,"./sv":262,"./sv.js":262,"./sw":263,"./sw.js":263,"./ta":264,"./ta.js":264,"./te":265,"./te.js":265,"./tet":266,"./tet.js":266,"./tg":267,"./tg.js":267,"./th":268,"./th.js":268,"./tl-ph":269,"./tl-ph.js":269,"./tlh":270,"./tlh.js":270,"./tr":271,"./tr.js":271,"./tzl":272,"./tzl.js":272,"./tzm":273,"./tzm-latn":274,"./tzm-latn.js":274,"./tzm.js":273,"./ug-cn":275,"./ug-cn.js":275,"./uk":276,"./uk.js":276,"./ur":277,"./ur.js":277,"./uz":278,"./uz-latn":279,"./uz-latn.js":279,"./uz.js":278,"./vi":280,"./vi.js":280,"./x-pseudo":281,"./x-pseudo.js":281,"./yo":282,"./yo.js":282,"./zh-cn":283,"./zh-cn.js":283,"./zh-hk":284,"./zh-hk.js":284,"./zh-tw":285,"./zh-tw.js":285};function a(e){var t=r(e);return n(t)}function r(e){if(n.o(s,e))return s[e];var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}a.keys=function(){return Object.keys(s)},a.resolve=r,(e.exports=a).id=467},476:function(e,t,n){},479:function(e,t,n){},480:function(e,t,n){},481:function(e,t,n){},483:function(e,t,n){},484:function(e,t,n){},485:function(e,t,n){"use strict";n.r(t);var i=n(0),c=n.n(i),s=n(7),a=n.n(s),r=n(75),o=n(49),l=n(128),u=n.n(l),d=(n(101),n(45)),m=(n(102),n(32)),f=(n(487),n(46)),p=(n(306),n(78)),h=(n(103),n(10)),g=n(25),y=n.n(g),v=n(26),b=n.n(v),j=n(27),S=n.n(j),w=n(28),I=n.n(w),E=n(12),D=n.n(E),N=n(29),O=n.n(N),k=n(9),C=n.n(k),M=n(22),T="SEND_COURSE_DETAIL",L="SHOW_DIALOG",U="HIDE_DIALOG",R="SELECT_STUDENT",V="COURSE_LIST",P=n(36),x=n.n(P),z=n(62),_=n.n(z),J=n(288),F=n.n(J),W=n(289),G=n.n(W),q=F.a.create({timeout:6e3});q.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded",q.interceptors.request.use(function(e){return console.log(e),"post"===e.method&&(e.data=G.a.stringify(e.data)),e},function(e){return loadinginstace.close(),Promise.reject(e)});var A=function(e,t,n){var a=2<arguments.length&&void 0!==n?n:{};return new Promise(function(n,s){q.post(e,t,a).then(function(e){var t=e.data.status.code;e.data.data.systemDate=e.data.systemDate,0===t?n(e.data.data):(d.a.error(e.data.status.message),s(e.data.message))}).catch(function(e,t){d.a.error(e.message),s(e,t)})})},H="alpha";H="http://dev.beiwaiguoji.com/api";function $(e){return H+e}var B,Y,K,Q,X,Z={USER:{LOGINJUMP:$("/ucenter/dispatch?action=loginWithPassword"),SEND_CODE:$("/ucenter/dispatch?action=sendUserSms"),LOGIN_PHONE:$("/ucenter/dispatch?action=loginSms")}},ee={getUserInfo:(K=_()(x.a.mark(function e(t){return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A(Z.USER.LOGINJUMP,t,{});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)})),function(e){return K.apply(this,arguments)}),sendCode:(Y=_()(x.a.mark(function e(t){return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A(Z.USER.SEND_CODE,t,{});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)})),function(e){return Y.apply(this,arguments)}),getPhoneUserInfo:(B=_()(x.a.mark(function e(t){return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A(Z.USER.LOGIN_PHONE,t,{});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)})),function(e){return B.apply(this,arguments)})},te={calendar:{list:$("/live/dispatch?action=liveCalendar"),entryStudio:$("/live/dispatch?action=callbackNotify")}},ne={getList:(X=_()(x.a.mark(function e(t,n){return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A(te[t].list,n,{});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)})),function(e,t){return X.apply(this,arguments)}),sendStudioCallback:(Q=_()(x.a.mark(function e(t,n){return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A(te[t].entryStudio,n,{});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)})),function(e,t){return Q.apply(this,arguments)})};function se(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,s)}return n}function ae(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?se(n,!0).forEach(function(e){C()(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):se(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function re(e){return{type:T,payload:ae({},e)}}function oe(e){return{type:"LOGIN",payload:ae({},e)}}function ie(e){return{type:L,payload:ae({},e)}}function ce(e){return{type:R,payload:ae({},e)}}function le(e){return function(t){return ne.getList("calendar",e).then(function(e){t(function(e){return{type:V,payload:ae({},e)}}({courseList:e.calendarList}))})}}function ue(e,t){if(!e)return"";t=t||"yyyy-MM-dd hh:mm";var n=new Date(e);/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(n.getFullYear()+"").substr(4-RegExp.$1.length)));var s={"M+":n.getMonth()+1,"d+":n.getDate(),"h+":n.getHours(),"m+":n.getMinutes(),"s+":n.getSeconds()};for(var a in s)if(new RegExp("(".concat(a,")")).test(t)){var r=s[a]+"";t=t.replace(RegExp.$1,1===RegExp.$1.length?r:("00"+r).substr(r.length))}return t}function de(e,t,n){console.log(n);for(var s=0;s<e.length;s++)if(ue(e[s][t],"yyyy-MM-dd")===n)return e[s];return!1}function me(e,t,n){for(var s=0;s<e.length;s++)if(e[s][t]===n)return e[s];return!1}function fe(e,t,n){var s=new Date,a=n;s.setTime(s.getTime()+24*a*3600*1e3),document.cookie=e+"="+t+";expires="+s.toGMTString()}function pe(){return window.WCRClassRoom&&window.WCRClassRoom.getClientType()}n(373);var he=function(e){function t(e){var n;return y()(this,t),n=S()(this,I()(t).call(this,e)),C()(D()(n),"handleSubmit",function(e){e.preventDefault(),n.props.form.validateFields(function(e,t){e||n.props.handleSubmit("account",{loginName:t.username,password:t.password})})}),C()(D()(n),"switchMethod",function(e){n.props.switchMethod(2)}),n.state={loading:!1,info:{}},n}return O()(t,e),b()(t,[{key:"componentDidMount",value:function(){this.setState({info:JSON.parse(localStorage.getItem("info"))||{}})}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return c.a.createElement(f.a,{onSubmit:this.handleSubmit,className:"login-form"},c.a.createElement(f.a.Item,null,e("username",{initialValue:this.state.info.loginName||"",rules:[{required:!0,message:"请输入账号!"}]})(c.a.createElement(p.a,{prefix:c.a.createElement(h.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"用户名"}))),c.a.createElement(f.a.Item,null,e("password",{initialValue:this.state.info.password||"",rules:[{required:!0,message:"请输入密码！"}]})(c.a.createElement(p.a,{prefix:c.a.createElement(h.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"密码"}))),c.a.createElement("p",{className:"login-form-phone",onClick:this.switchMethod},"手机号登陆？"),c.a.createElement(f.a.Item,null,c.a.createElement(m.a,{type:"primary",block:!0,htmlType:"submit",loading:this.state.loading,className:"login-form-button"},"登录")))}}]),t}(i.Component),ge=function(e){function t(e){var n;return y()(this,t),n=S()(this,I()(t).call(this,e)),C()(D()(n),"handleSubmit",function(e){e.preventDefault(),n.props.form.validateFields(function(e,t){e||n.props.handleSubmit("phone",{mobile:t.phone,smsCode:t.code})})}),C()(D()(n),"switchMethod",function(e){n.props.switchMethod(1)}),C()(D()(n),"sendCode",function(e){n.props.form.validateFields(["phone"],function(e){if(!e){n.setState(function(e){return{isSend:!0}});var t={mobile:n.props.form.getFieldValue("phone"),userSmsType:0,deviceType:1,deviceSerialNo:"pc"+n.props.uuid};ee.sendCode(t).then(function(e){n.setState({interval:setInterval(function(){n.setState(function(e,t){return console.log(e,t),{number:--e.number}}),57===n.state.number&&n.setState(function(e){return clearInterval(n.state.interval),{isSend:!1,number:60}})},1e3)})}).catch(function(e){n.setState(function(e){return{isSend:!1}})})}})}),C()(D()(n),"validatorPhone",function(e,t,n){console.log(t,"---");0===t.length?n("请输入手机号码"):/^1[3456789]\d{9}$/.test(t)||n("手机号码输入有误"),n()}),n.state={loading:!1,info:{},isSend:!1,number:60,interval:null,phone:""},n}return O()(t,e),b()(t,[{key:"render",value:function(){var s=this,e=this.props.form.getFieldDecorator,t=this.state,n=t.isSend,a=t.number;return c.a.createElement(f.a,{onSubmit:this.handleSubmit,className:"login-form"},c.a.createElement(f.a.Item,null,e("phone",{initialValue:this.state.phone||"",rules:[{validator:function(e,t,n){return s.validatorPhone(e,t,n)}}]})(c.a.createElement(p.a,{prefix:c.a.createElement(h.a,{type:"phone",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"手机号"}))),c.a.createElement(f.a.Item,null,e("code",{rules:[{required:!0,message:"请输入验证码!"}]})(c.a.createElement("div",{className:"flex-center phone-box"},c.a.createElement(p.a,{placeholder:"验证码"})," ",c.a.createElement(m.a,{type:"primary",onClick:this.sendCode,disabled:n},n?a+"s":"发送")))),c.a.createElement("p",{className:"login-form-phone",onClick:this.switchMethod},"账号密码登陆？"),c.a.createElement(f.a.Item,null,c.a.createElement(m.a,{type:"primary",block:!0,htmlType:"submit",loading:this.state.loading,className:"login-form-button"},"登录")))}}]),t}(i.Component),ye=function(e){function t(e){var r;return y()(this,t),r=S()(this,I()(t).call(this,e)),C()(D()(r),"handleSubmit",function(){var s=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"account",a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};r.props.form.validateFields(function(e){if(!e){r.setState({loading:!0}),localStorage.setItem("uuid",r.state.uuid);var t={deviceType:1,deviceSerialNo:"pc-"+r.state.uuid},n=ee.getUserInfo;"account"===s?(t.loginName=a.loginName,t.password=a.password):(t.mobile=a.mobile,t.smsCode=a.smsCode,n=ee.getPhoneUserInfo),n(t).then(function(e){var t=pe();if(1===e.userMessageVo.userType&&"student"===t)return d.a.error("请登录教师端！"),void r.setState({loading:!1});if(1!==e.userMessageVo.userType&&"teacher"===t)return d.a.error("请登录学生端！"),void r.setState({loading:!1});if(4===e.userMessageVo.userType&&0===e.userMessageVo.subUserInfoVoList.length)return d.a.error("您未添加学生"),void r.setState({loading:!1});r.setState({loading:!1});var n={};0<e.userMessageVo.subUserInfoVoList.length?(n.id=e.userMessageVo.subUserInfoVoList[0].userId,n.name=e.userMessageVo.subUserInfoVoList[0].userName,n.password="0",n.token=e.userMessageVo.loginToken,n.avatar="http://snsimg.ztjystore.cn/ztnew/ad/img/2019/07/05/1562295571719403.png",n.mobile=e.userMessageVo.subUserInfoVoList[0].mobile||"0",e.userMessageVo.subUserInfoVoList[0].select=!0,r.props.setStudent({studentInfo:e.userMessageVo.subUserInfoVoList[0]})):(n.id=e.userMessageVo.userId,n.name=e.userMessageVo.userName,n.password="0",n.token=e.userMessageVo.loginToken,n.avatar="http://snsimg.ztjystore.cn/ztnew/ad/img/2019/07/05/1562295571719403.png",n.mobile=e.userMessageVo.mobile||"0",r.props.setStudent({studentInfo:e.userMessageVo}),e.userMessageVo.select=!0);n.type={1:"teacher",2:"student",3:"student",4:"student"}[e.userMessageVo.userType]||"student",r.props.setUserInfo({userInfo:e.userMessageVo}),fe("userInfo",encodeURI(JSON.stringify(e.userMessageVo)),30),localStorage.setItem("userInfo",JSON.stringify(e.userMessageVo)),localStorage.setItem("info",JSON.stringify({loginName:a.loginName,password:a.password})),console.log({loginName:a.loginName,password:a.password}),console.log(JSON.stringify(n)),r.props.history.push("/broadcast/course")}).catch(function(e){r.setState({loading:!1})})}})}),C()(D()(r),"switchMethod",function(e){r.setState({loginType:e})}),r.state={loginType:1,info:{},uuid:""},r}return O()(t,e),b()(t,[{key:"componentDidMount",value:function(){this.setState({info:JSON.parse(localStorage.getItem("info"))||{},uuid:localStorage.getItem("uuid")?localStorage.getItem("uuid"):function(){for(var e=[],t="0123456789abcdef",n=0;n<36;n++)e[n]=t.substr(Math.floor(16*Math.random()),1);return e[14]="4",e[19]=t.substr(3&e[19]|8,1),e[8]=e[13]=e[18]=e[23]="-",e.join("")}()}),console.log(localStorage.getItem("info"))}},{key:"render",value:function(){var e=this.state.loginType;return c.a.createElement(i.Fragment,null,c.a.createElement("div",{className:"login-wrapper"},c.a.createElement("div",{className:"login-wrapper-layout"},c.a.createElement("div",{className:"login-logo"}),1===e&&c.a.createElement(he,u()({handleSubmit:this.handleSubmit,switchMethod:this.switchMethod},this.props,{info:this.state.info})),2===e&&c.a.createElement(ge,u()({handleSubmit:this.handleSubmit,uuid:this.state.uuid,switchMethod:this.switchMethod},this.props)))))}}]),t}(i.Component),ve=f.a.create({name:"normal_login"})(ye),be=Object(M.connect)(null,{setUserInfo:oe,setStudent:ce})(ve),je=(n(486),n(295)),Se=(n(465),"");function we(){return c.a.createElement("div",{className:"calendar-header flex-center"},c.a.createElement("div",{className:"calendar-header-refresh flex-center",onClick:function(){window.webAdapter.reload()}},c.a.createElement(h.a,{type:"sync",style:{fontSize:"18px",color:"#5fa2ee"}})))}var Ie=function(e){function t(e){var r;return y()(this,t),r=S()(this,I()(t).call(this,e)),C()(D()(r),"filterMonthsCourse",function(t){var n=[];return r.props.courseData.forEach(function(e){ue(e.date,"yyyy-MM-dd")===t&&n.push(e)}),n}),C()(D()(r),"dateCellRender",function(e){var t=e.month()+1<10?"0"+(e.month()+1):e.month()+1,n=e.date()<10?"0"+e.date():e.date(),s=e.year(),a=r.filterMonthsCourse("".concat(s,"-").concat(t,"-").concat(n));return c.a.createElement("ul",{className:"events"},a.map(function(e){return c.a.createElement("div",{key:e.date,className:"date-item"})}))}),C()(D()(r),"onSelect",function(e){var t=e.month()+1<10?"0"+(e.month()+1):e.month()+1,n="".concat(e.year(),"-").concat(t,"-").concat(e.date()<10?"0"+e.date():e.date()),s=de(r.props.courseData,"date",n)||{};Se===e.month()&&r.props.sendCourseDetail({courseData:s})}),C()(D()(r),"onPanelChange",function(e){r.props.changeDate(e)}),r}return O()(t,e),b()(t,[{key:"render",value:function(){return c.a.createElement(i.Fragment,null,c.a.createElement(we,null),c.a.createElement("div",{className:"calendar-wrapper"},c.a.createElement(je.a,{onPanelChange:this.onPanelChange,onSelect:this.onSelect,dateCellRender:this.dateCellRender,fullscreen:!1,ref:"myInput",headerRender:function(e){var n=e.value,s=e.onChange;Se=n.month();var t=n.year();return c.a.createElement("div",{style:{padding:10}},c.a.createElement("div",{className:"flex-center"},c.a.createElement("div",{className:"calendar-caret flex-center",onClick:function(){var e=Se,t=n.clone();t.month(parseInt(--e,10)),s(t)}},c.a.createElement(h.a,{type:"caret-left",style:{fontSize:"20px",color:"#a9a9a9"}})),c.a.createElement("div",{className:"calendar-date"},"".concat(t,"年").concat(Se+1,"月")),c.a.createElement("div",{className:"calendar-caret flex-center",onClick:function(){var e=Se,t=n.clone();t.month(parseInt(++e,10)),s(t)}},c.a.createElement(h.a,{type:"caret-right",style:{fontSize:"20px",color:"#a9a9a9"}}))))}})))}}]),t}(i.Component),Ee=Object(M.connect)(null,{sendCourseDetail:re})(Ie),De=n(1),Ne=n.n(De),Oe=(n(476),function(e){function n(e){var t;return y()(this,n),t=S()(this,I()(n).call(this,e)),C()(D()(t),"handleSignOut",function(){window.WCRClassRoom.setUser(""),Router.push("/broadcast/login")}),C()(D()(t),"handleSwitchStudent",function(){t.props.showDialog({status:!0})}),C()(D()(t),"handleAvatar",function(){}),C()(D()(t),"handleGender",function(e){return 1===e.gender?"http://snsimg.ztjystore.cn/1562303034TyAFquWFiu":2===e.gender?"http://snsimg.ztjystore.cn/ztnew/ad/img/2019/07/05/1562291591660101.jpg?imageView2/2/w/720":"http://snsimg.ztjystore.cn/article/2019/07/05/1562281563183957.jpg?imageView2/2/w/720"}),t.state={platform:""},t}return O()(n,e),b()(n,[{key:"componentDidMount",value:function(){this.setState({platform:pe()})}},{key:"render",value:function(){var e=me(this.props.studentInfo,"select",!0);return c.a.createElement("aside",{className:"sidebar-container"},c.a.createElement("div",{className:"sidebar-avatar",style:{background:"url(".concat(this.handleGender(e),") no-repeat")}}),c.a.createElement("div",{className:"sidebar-name"},e.userName),c.a.createElement("ul",{className:"nav"},c.a.createElement("li",{className:"nav-item"},c.a.createElement(h.a,{type:"calendar"}),c.a.createElement("div",{className:"nav-item-title"},"课程表")),"student"===this.state.platform&&c.a.createElement("li",{className:"nav-item",onClick:this.handleSwitchStudent},c.a.createElement(h.a,{type:"team"}),c.a.createElement("div",{className:"nav-item-title"},"切换学生")),c.a.createElement("li",{className:"nav-item",onClick:this.handleSignOut},c.a.createElement(h.a,{type:"logout"}),c.a.createElement("div",{className:"nav-item-title"},"退出登录"))))}}]),n}(i.Component));Oe.propTypes={userInfo:Ne.a.object.isRequired},Oe.defaultProps={userInfo:{}};var ke=Object(M.connect)(function(e){return{studentInfo:e.course.studentInfo}},{showDialog:ie})(Oe),Ce=(n(477),n(296)),Me=(n(479),function(e){function t(e){var n;return y()(this,t),n=S()(this,I()(t).call(this,e)),C()(D()(n),"handleOk",function(e){}),C()(D()(n),"handleStudentInfo",function(t){t.select||n.props.handleDialogSwitchStudent(t.userId),n.state.students.map(function(e){e.select=!1,t.userId===e.userId&&(e.select=!0)});var e=JSON.parse(JSON.stringify(n.props.userInfo));e.subUserInfoVoList=JSON.parse(JSON.stringify(n.state.students)),n.props.setStudent({studentInfo:JSON.parse(JSON.stringify(n.state.students))}),fe("userInfo",encodeURI(JSON.stringify(e)),30),localStorage.setItem("userInfo",JSON.stringify(e)),n.handleLogin(t),n.props.hideDialog({status:!1})}),C()(D()(n),"handleLogin",function(e){window.WCRClassRoom.setUser("");var t={id:e.userId,name:e.userName,password:"0",token:n.props.userInfo.loginToken,avatar:"http://snsimg.ztjystore.cn/ztnew/ad/img/2019/07/05/1562295571719403.png",mobile:e.mobile||0,type:"student"};window.WCRClassRoom.setUser(t)}),C()(D()(n),"handleGender",function(e){return 1===e.gender?"http://snsimg.ztjystore.cn/1562303034TyAFquWFiu":2===e.gender?"http://snsimg.ztjystore.cn/ztnew/ad/img/2019/07/05/1562291591660101.jpg?imageView2/2/w/720":"http://snsimg.ztjystore.cn/article/2019/07/05/1562281563183957.jpg?imageView2/2/w/720"}),C()(D()(n),"handleCancel",function(e){n.props.hideDialog({status:!1})}),n.state={loading:!1,students:[]},n}return O()(t,e),b()(t,[{key:"componentDidMount",value:function(){var e=JSON.parse(localStorage.getItem("userInfo")).subUserInfoVoList;this.setState({students:e})}},{key:"render",value:function(){var n=this;return c.a.createElement("div",null,c.a.createElement(Ce.a,{visible:this.props.status,title:"切换学生",onOk:this.handleOk,onCancel:this.handleCancel,width:"50%",footer:null},c.a.createElement("div",{className:"student"},this.state.students.map(function(e,t){return c.a.createElement("div",{key:t,className:"student-item",onClick:function(){return n.handleStudentInfo(e)}},c.a.createElement("div",{className:"student-item-avatar",style:{background:"url(".concat(n.handleGender(e),") no-repeat")}}),c.a.createElement("div",{className:"student-item-name"},e.userName),e.select&&c.a.createElement("div",{className:"student-item-icon"},"当前"))}))))}}]),t}(i.Component));Object(M.connect)(function(e){return{status:e.course.status}},{showDialog:ie,hideDialog:function(e){return{type:U,payload:ae({},e)}},setStudent:ce})(Me),n(480);function Te(){return c.a.createElement(i.Fragment,null,c.a.createElement("div",{className:"course-header flex-center"},"我的课程"))}function Le(e){var t=e.courseData,n=void 0===t?{}:t,r=(e.userInfo,e.clearInterval);function a(e,t){var n;return{text:{1:"待上课",2:"开课中",3:"已下课",4:"无效",5:"已失效"},color:(n={3:"#e2e2e2"},C()(n,"3","#e2e2e2"),C()(n,"5","#e2e2e2"),C()(n,"1","#a6d4f5"),C()(n,"2","#a6d4f5"),n),button:{1:"进入教室",2:"进入教室",3:"查看回放",4:"无效",5:"已失效"},type:{1:"0",2:"7",3:"2"},courseStatus:{1:1,2:2,3:3,4:-1,5:4}}[t][e]}function s(t){if(1===t.status||2===t.status||3===t.status){var n={institutionId:1014,id:t.id,title:t.title,scenario:a(t.classType,"type"),startTime:t.startTime,endTime:t.endTime,status:a(t.status,"courseStatus"),teacher_name:t.teacher.userName,teacher_id:t.teacher.id,lesson_slide_url:t.broadcastingInfo.lessonSlideUrl,lesson_slide_backup_url:t.broadcastingInfo.lessonSlideBackupUrl};t.actualStartTime&&(n.actualStartTime=t.actualStartTime),3===t.classType&&(n.needLianMai=1,n.record_mode=4),2===t.classType&&(n.students=[],t.broadcastingInfo.students.forEach(function(e){n.students.push({id:e.id,name:e.userName,avatar:e.avatar})}));var e=JSON.parse(localStorage.getItem("userInfo")),s={token:e.loginToken};0<e.subUserInfoVoList.length?s.subUserId=me(e.subUserInfoVoList,"select",!0).userId:s.subUserId=e.userId,console.log(JSON.stringify(s)),WCRClassRoom.joinClassRoom(JSON.stringify(n),function(e){!function(e,t,n){if("startClass"===e.notify){window.WCRClassRoom.web_log(JSON.stringify(e)),console.log("点击上课按钮"),console.log(n.subUserId);var s={token:n.token,subUserId:n.subUserId,notify:"startClass",data:JSON.stringify(e.body)};ne.sendStudioCallback("calendar",s).then(function(e){o({status:1,lesson:t.id,actual_time:t.actualStartTime?ue(t.actualStartTime,"yyyy-MM-dd hh:mm:ss"):ue(e.systemDate,"yyyy-MM-dd hh:mm:ss"),server_time:ue(e.systemDate,"yyyy-MM-dd hh:mm:ss"),notify:"startClass"}),console.log({status:1,lesson:t.id,actual_time:t.actualStartTime?ue(t.actualStartTime,"yyyy-MM-dd hh:mm:ss"):ue(e.systemDate,"yyyy-MM-dd hh:mm:ss"),server_time:ue(e.systemDate,"yyyy-MM-dd hh:mm:ss"),notify:"startClass",time:t.actualStartTime},"--------")}).catch(function(e){o({status:2,lesson:t.id,actual_time:t.actualStartTime?ue(t.actualStartTime,"yyyy-MM-dd hh:mm:ss"):ue(res.systemDate,"yyyy-MM-dd hh:mm:ss"),server_time:ue(res.systemDate,"yyyy-MM-dd hh:mm:ss"),notify:"startClass"})})}else if("endClass"===e.notify){WCRClassRoom.web_log(JSON.stringify(e)),console.log("点击下课按钮");var a={token:n.token,subUserId:n.subUserId,notify:"endClass",data:JSON.stringify(e.body)};ne.sendStudioCallback("calendar",a).then(function(e){o({status:1,lesson:t.id,notify:"endClass"})}).catch(function(e){o({status:2,lesson:t.id,notify:"endClass"})})}else"enterClassRoom"===e.notify?(r(),console.log("进入教室"),WCRClassRoom.web_log(JSON.stringify(e))):"leaveClassRoom"===e.notify?(WCRClassRoom.web_log(JSON.stringify(e)),window.webAdapter.reload(),console.log("离开教室")):"rewardinfo"===e.notify&&console.log(JSON.parse(JSON.stringify(e)))}(e,t,s)})}d.a.warning("该课程".concat(已失效))}function o(e){var t=0<arguments.length&&void 0!==e?e:{},n=t.status,s=t.lesson,a=t.actual_time,r=t.server_time,o=t.notify,i={notify:o,body:{status:n}};"startClass"===o&&(i.body.data={lesson:s,actual_time:a,server_time:r}),"endClass"===o&&(i.body.data={lesson:s}),window.WCRClassRoom.commonNotifyCallback(0,i)}return Object.keys(n).length<1?c.a.createElement(i.Fragment,null,c.a.createElement("div",{className:"no-data"},"暂无课程")):c.a.createElement("ul",{className:"list-item hide-scroll"},n.courseList.map(function(e){return c.a.createElement("li",{key:e.id},c.a.createElement("p",{className:"list-item-title"},e.title),c.a.createElement("p",{className:"list-item-type"},function(e){switch(e){case 1:return"一对一";case 2:return"小班课";case 3:return"大班课";case 4:return"广播课"}}(e.classType),"  ",ue(+new Date(e.startTime.replace(/-/g,"/")),"hh:mm"),"-",ue(+new Date(e.endTime.replace(/-/g,"/")),"hh:mm")),c.a.createElement("p",{className:"list-item-name"},e.teacher.userName),c.a.createElement("div",{className:"list-item-status",style:{backgroundColor:a(e.status,"color")}},a(e.status,"text")),c.a.createElement("dir",{className:"list-item-button"},c.a.createElement("button",{onClick:function(){return s(e)}},a(e.status,"button"))))}))}var Ue=function(e){function t(e){return y()(this,t),S()(this,I()(t).call(this,e))}return O()(t,e),b()(t,[{key:"render",value:function(){var e=this.props,t=e.courseData,n=e.userInfo,s=e.clearInterval;return c.a.createElement(i.Fragment,null,c.a.createElement(Te,{userInfo:n}),c.a.createElement(Le,{userInfo:n,clearInterval:s,courseData:t}))}}]),t}(i.Component),Re=Object(M.connect)(function(e){return{courseData:e.course.courseData}},null)(Ue);n(481);function Ve(e,t){var n=new Date(e),s=n.getMonth()+1,a=n.getFullYear(),r=20;return"startDate"===t?0===--s&&(s=12,--a):(r=10,13===++s&&(s=1,++a)),"".concat(a,"-").concat(s<10?"0"+s:s,"-").concat(r)}var Pe=function(e){function t(e){var s;return y()(this,t),s=S()(this,I()(t).call(this,e)),C()(D()(s),"clientRequest",function(){var e=s.props.userInfo,t={token:e.loginToken,startDate:Ve(new Date,"startDate"),endDate:Ve(new Date,"endDate")};0<e.subUserInfoVoList.length?t.subUserId=me(e.subUserInfoVoList,"select",!0).userId:t.subUserId=e.userId,s.props.awaitCourseList(t)}),C()(D()(s),"clearInterval",function(e){s.setState(function(e){clearTimeout(e.interval)})}),C()(D()(s),"changeDate",function(e){var t="".concat(e.year(),"-").concat(e.month()+1<10?"0"+(e.month()+1):e.month()+1,"-").concat(e.date()<10?"0"+e.date():e.date()),n="".concat(e.year(),"-").concat(e.month()+1<10?"0"+(e.month()+1):e.month()+1);s.setState(function(e){e.currentDate=n,e.yearMonth=n,e.changeDate=t,0<s.props.userInfo.subUserInfoVoList.length?s.getCourseList(s.state.studentId||me(s.props.userInfo.subUserInfoVoList,"select",!0).userId):s.getCourseList(s.props.userInfo.userId)})}),C()(D()(s),"getCourseList",function(e){var t={token:s.props.userInfo.loginToken,subUserId:e,startDate:Ve(s.state.yearMonth,"startDate"),endDate:Ve(s.state.yearMonth,"endDate")};0<s.props.userInfo.subUserInfoVoList.length&&(t.subUserId=e),ne.getList("calendar",t).then(function(e){s.setState({courseData:e.calendarList}),s.checkTodayCourse(+new Date(s.state.changeDate))})}),C()(D()(s),"handleDialogSwitchStudent",function(e){s.setState({studentId:e}),s.getCourseList(e)}),C()(D()(s),"checkTodayCourse",function(e){var t=ue(e,"yyyy-MM-dd");console.log(1),s.props.sendCourseDetail({courseData:de(s.state.courseData,"date",t)||{}})}),C()(D()(s),"showLesson",function(){var e=s.props.courseListStore,t={lesson:0,lessonLength:0};return Object.keys(e).length<1||(t.lesson=e.courseList.length,t.lessonLength=e.courseList.filter(function(e){return 1!==e.status&&2!==e.status}).length),t}),s.state={courseData:[],currentDate:new Date,interval:null,yearMonth:ue(+new Date,"yyyy-MM"),changeDate:ue(+new Date,"yyyy-MM-dd"),studentId:""},0<s.props.userInfo.subUserInfoVoList.length?s.props.setStudent({studentInfo:s.props.userInfo.subUserInfoVoList}):s.props.setStudent({studentInfo:[s.props.userInfo]}),s}return O()(t,e),b()(t,[{key:"componentWillMount",value:function(){this.props.courseListStore||(this.clientRequest(),this.setState({courseData:this.props.courseListStore}))}},{key:"componentDidMount",value:function(){console.log(this.props.courseListStore),console.log(this.props.userInfo,"2"),window.resizeTo(1080,650),this.checkTodayCourse(+new Date(this.state.currentDate)),this.setState({})}},{key:"render",value:function(){var e=this.props.userInfo;return c.a.createElement(i.Fragment,null,c.a.createElement("div",{className:"content-layout"},c.a.createElement(ke,{userInfo:e}),c.a.createElement("div",{className:"content-layout-right flex-center"},c.a.createElement("div",{className:"content-layout-right-box"},c.a.createElement("div",{className:"content-layout-right-caleandar"},c.a.createElement(Ee,{changeDate:this.changeDate,courseData:this.state.courseData})),c.a.createElement("div",{className:"content-layout-right-course"},c.a.createElement(Re,{clearInterval:this.clearInterval,userInfo:e}))),c.a.createElement("div",{className:"content-layout-right-carryout"},"共",this.showLesson().lesson,"节课 | 完成",this.showLesson().lessonLength,"节"))))}}]),t}(i.Component),xe=Object(M.connect)(function(e){var t=e.course,n=t.courseList;return{courseDataStore:t.courseData,courseListStore:n,userInfo:e.login.userInfo}},{sendCourseDetail:re,setStudent:ce,setUserInfo:oe})(Pe);xe.getInintalProps=function(e,t){var n=JSON.parse(t.userInfo);e.dispatch(oe({userInfo:n}));var s={token:n.loginToken,startDate:Ve(new Date,"startDate"),endDate:Ve(new Date,"endDate")};return 0<n.subUserInfoVoList.length?s.subUserId=me(n.subUserInfoVoList,"select",!0).userId:s.subUserId=n.userId,e.dispatch(le(s))};function ze(){return c.a.createElement(i.Fragment,null,_e.map(function(e){return c.a.createElement(o.Route,e)}))}var _e=[{path:"/",component:be,exact:!0,key:"Home"},{path:"/broadcast/login",component:be,key:"login",exact:!0},{path:"/broadcast/course",component:xe,key:"course",exact:!0,loadData:xe.getInintalProps}],Je=n(43),Fe=n(133);function We(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,s)}return n}function Ge(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?We(n,!0).forEach(function(e){C()(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):We(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var qe={courseData:{},status:!1,studentInfo:{},courseList:{}};function Ae(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,s)}return n}function He(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ae(n,!0).forEach(function(e){C()(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ae(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var $e={userInfo:null,list:[]},Be=Object(Je.combineReducers)({course:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:qe,t=1<arguments.length?arguments[1]:void 0;switch(t.type){case T:return Ge({},e,{},t.payload);case L:case U:case R:case V:return Ge({},e,{},t.payload);default:return e}},login:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:$e,t=1<arguments.length?arguments[1]:void 0;switch(console.log(t,"===============asdasdas"),t.type){case"LOGIN":t.payload;return He({},e,{},t.payload);case"TEST":return He({},e,{},t.payload);default:return e}}});function Ye(){return c.a.createElement(M.Provider,{store:function(){var e=window._REACT_SOTRE?window._REACT_SOTRE:{};return Object(Je.createStore)(Be,e,Object(Je.applyMiddleware)(Fe.a))}()},c.a.createElement(r.BrowserRouter,null,c.a.createElement(ze,null)))}n(483),n(484);a.a.hydrate(c.a.createElement(Ye,null),document.getElementById("root"))}},[[485,1,2]]]);